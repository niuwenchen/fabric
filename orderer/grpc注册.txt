grpc过程

1 服务端
    net.listen() 启动监听任务
    lis, err := net.Listen("tcp", fmt.Sprintf("%s:%d", conf.General.ListenAddress, conf.General.ListenPort))

    实例化GrpcServer
    s := grpc.NewServer()
    grpcServer, err := comm.NewGRPCServerFromListener(lis, serverConfig)
    GrpcServer 是 server的封装
    最后也是: grpcServer.server = grpc.NewServer(serverOpts...)

2 CA
caSupport := &comm.CASupport{
		AppRootCAsByChain:     make(map[string][][]byte),
		OrdererRootCAsByChain: make(map[string][][]byte),
		ClientRootCAs:         serverConfig.SecOpts.ClientRootCAs,
	}


3 manager
manager := initializeMultichannelRegistrar(conf, signer, tlsCallback)
    有个SystemChannel 这个变量 使用的是默认的值 test-system-channel-name ,如果在orderer.yaml中设置就会报错，应该从头开始生成一份genesi文件

(0x11f11a0,0xc42055f8c0) header:<data_hash:"v8O1\376\3750\370\304_m\034\006\376\227\237f\372oy\325c\242 \031N\332\352\276\2161_" > data:<data:"\n\202b\n\206\001\nh\010\001\020\001\032\006\010\207\335\276\343\005\"\030test-system-channel-name*@34d922b130152da6e5e178d91e4aa757b309d3358db6da547b7f1ce0756e2161\022\032\022\030V\376\321\255\2755\273\217\240\253\206\301\005\322\376l(<5\211\365\005\324\000\022\366`\n\363`\022\360`\022\231\027\n\007Orderer\022\215\027\022\342\024\n\nOrdererOrg\022\323\024\032\250\023\n\003MSP\022\240\023\022\225\023\022\222\023\n\nOrdererMSP\022\262\006-----BEGIN CERTIFICATE-----\nMIICMDCCAdagAwIBAgIRAMO9uEwTOpty9MCDUznek0UwCgYIKoZIzj0EAwIwaTEL\nMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNhbiBG\ncmFuY2lzY28xFDASBgNVBAoTC2V4YW1wbGUuY29tMRcwFQYDVQQDEw5jYS5leGFt\ncGxlLmNvbTAeFw0xOTAyMjEwMzE0MDBaFw0yOTAyMTgwMzE0MDBaMGkxCzAJBgNV\nBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1TYW4gRnJhbmNp\nc2NvMRQwEgYDVQQKEwtleGFtcGxlLmNvbTEXMBUGA1UEAxMOY2EuZXhhbXBsZS5j\nb20wWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAQ2adqMI7BpeHi5N+FnUH8I0uKS\n5n0jQL/cYMQxG8ebxYfm4LRhNcAtJisb/XlZMSNhfHJk7IR0BhEbihV1BcYdo18w\nXTAOBgNVHQ8BAf8EBAMCAaYwDwYDVR0lBAgwBgYEVR0lADAPBgNVHRMBAf8EBTAD\nAQH/MCkGA1UdDgQiBCDkm/pq1CRmvtT2fVZk4BJp7sh1M7xfmvbkeZ26zJb7MDAK\nBggqhkjOPQQDAgNIADBFAiEA9QHpp5zoL/Bmvk6E1JEbslZjAfI3dcw5xnH+QA7r\nEFwCIGCFts9c6tskqSuRtKCFqC+1gZ30Dz8QTmpa+Dy6bze4\n-----END CERTIFICATE-----\n\"\201\006-----BEGIN CERTIFICATE-----\nMIICCzCCAbGgAwIBAgIRAKkNsgJCg6/RViIgHLhBEfkwCgYIKoZIzj0EAwIwaTEL\nMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNhbiBG\ncmFuY2lzY28xFDASBgNVBAoTC2V4YW1wbGUuY29tMRcwFQYDVQQDEw5jYS5leGFt\ncGxlLmNvbTAeFw0xOTAyMjEwMzE0MDBaFw0yOTAyMTgwMzE0MDBaMFYxCzAJBgNV\nBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1TYW4gRnJhbmNp\nc2NvMRowGAYDVQQDDBFBZG1pbkBleGFtcGxlLmNvbTBZMBMGByqGSM49AgEGCCqG\nSM49AwEHA0IABFCBSHzZOvk8rNhdanQ+M6idq7J2SNfmJj1heqQ2kWWYbbasCivF\n/8Sc1D+Rj2Olsl+1jomNH7stGuYBxsjvBLujTTBLMA4GA1UdDwEB/wQEAwIHgDAM\nBgNVHRMBAf8EAjAAMCsGA1UdIwQkMCKAIOSb+mrUJGa+1PZ9VmTgEmnuyHUzvF+a\n9uR5nbrMlvswMAoGCCqGSM49BAMCA0gAMEUCIQDjsJfkLke0ld4jKrXXhu2UCdY/\nZaJIP/7Ie9/WE5eXVAIgdHtzh7+UpspBWHFpTIpDRkJ5XNqvxYJopGe3e+2wtgM=\n-----END CERTIFICATE-----\nB\016\n\004SHA2\022\006SHA256J\272\006-----BEGIN CERTIFICATE-----\nMIICNTCCAdygAwIBAgIRAN4z2JG9JW7J/0mJ06YSSxEwCgYIKoZIzj0EAwIwbDEL\nMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNhbiBG\ncmFuY2lzY28xFDASBgNVBAoTC2V4YW1wbGUuY29tMRowGAYDVQQDExF0bHNjYS5l\neGFtcGxlLmNvbTAeFw0xOTAyMjEwMzE0MDBaFw0yOTAyMTgwMzE0MDBaMGwxCzAJ\nBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1TYW4gRnJh\nbmNpc2NvMRQwEgYDVQQKEwtleGFtcGxlLmNvbTEaMBgGA1UEAxMRdGxzY2EuZXhh\nbXBsZS5jb20wWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAS64ZEAPD/clAsaks3D\nDeIXc872KABb1oZX+IBAL/spLfL4sVN1ONe781jHbIgPx+Z5zAwVexqA19PX9L+d\nFkY5o18wXTAOBgNVHQ8BAf8EBAMCAaYwDwYDVR0lBAgwBgYEVR0lADAPBgNVHRMB\nAf8EBTADAQH/MCkGA1UdDgQiBCCtPn2lzfFefn6bMEQbFB7d4ijZlJY7R1ZJuPm2\nWKSr3TAKBggqhkjOPQQDAgNHADBEAiBMW7zSTokuAC0a4oSap6YfgX14E/kDI49T\n+7fdIb45EQIgZCDA7/56nBscyQGg5Gk66Y2hUKnjEpFLaKHY76OUo6g=\n-----END CERTIFICATE-----\n\032\006Admins\"4\n\006Admins\022*\022 \010\001\022\034\022\010\022\006\010\001\022\002\010\000\032\020\022\016\n\nOrdererMSP\020\001\032\006Admins\"3\n\007Readers\022(\022\036\010\001\022\032\022\010\022\006\010\001\022\002\010\000\032\016\022\014\n\nOrdererMSP\032\006Admins\"3\n\007Writers\022(\022\036\010\001\022\032\022\010\022\006\010\001\022\002\010\000\032\016\022\014\n\nOrdererMSP\032\006Admins*\006Admins\032!\n\rConsensusType\022\020\022\006\n\004solo\032\006Admins\032\"\n\tBatchSize\022\025\022\013\010\n\020\200\200\2001\030\200\200 \032\006Admins\032\036\n\014BatchTimeout\022\016\022\004\n\0022s\032\006Admins\032\037\n\023ChannelRestrictions\022\010\032\006Admins\"\"\n\007Writers\022\027\022\r\010\003\022\t\n\007Writers\032\006Admins\"*\n\017BlockValidation\022\027\022\r\010\003\022\t\n\007Writers\032\006Admins\"\"\n\006Admins\022\030\022\016\010\003\022\n\n\006Admins\020\002\032\006Admins\"\"\n\007Readers\022\027\022\r\010\003\022\t\n\007Readers\032\006Admins*\006Admins\022\273G\n\013Consortiums\022\253G\022\340F\n\020SampleConsortium\022\313F\022\367\"\n\007Org1MSP\022\353\"\032\311!\n\003MSP\022\301!\022\266!\022\263!\n\007Org1MSP\022\317\006-----BEGIN CERTIFICATE-----\nMIICQzCCAemgAwIBAgIQSzrwaUb5ktYvJzlJTNI2tTAKBggqhkjOPQQDAjBzMQsw\nCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNU2FuIEZy\nYW5jaXNjbzEZMBcGA1UEChMQb3JnMS5leGFtcGxlLmNvbTEcMBoGA1UEAxMTY2Eu\nb3JnMS5leGFtcGxlLmNvbTAeFw0xOTAyMjEwMzE0MDBaFw0yOTAyMTgwMzE0MDBa\nMHMxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1T\nYW4gRnJhbmNpc2NvMRkwFwYDVQQKExBvcmcxLmV4YW1wbGUuY29tMRwwGgYDVQQD\nExNjYS5vcmcxLmV4YW1wbGUuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE\ntJZZcvoFBzN6Uqd2aB1uJykRwmArk+AkoFA/Q4pZw/UfdgXP2gq4PepgOiqFPMbv\nIngDEoJ+UgeqXn54lFGaUqNfMF0wDgYDVR0PAQH/BAQDAgGmMA8GA1UdJQQIMAYG\nBFUdJQAwDwYDVR0TAQH/BAUwAwEB/zApBgNVHQ4EIgQgYwHBX2iF8dp2gqrQuogW\n4WKORHHCS57o1yDmsNV9tDowCgYIKoZIzj0EAwIDSAAwRQIhAIEygEzATAwZ8OEU\nkF/DgB3h9hjS3imFRjFWOz3Bo9CQAiA8OMPhq4pdehrIqjtGw9iASAxpFcKTHOY4\nUmPDBehBXA==\n-----END CERTIFICATE-----\n\"\256\006-----BEGIN CERTIFICATE-----\nMIICKzCCAdGgAwIBAgIRANYCAYvPvb0FJAcHvZdGe3UwCgYIKoZIzj0EAwIwczEL\nMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNhbiBG\ncmFuY2lzY28xGTAXBgNVBAoTEG9yZzEuZXhhbXBsZS5jb20xHDAaBgNVBAMTE2Nh\nLm9yZzEuZXhhbXBsZS5jb20wHhcNMTkwMjIxMDMxNDAwWhcNMjkwMjE4MDMxNDAw\nWjBsMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMN\nU2FuIEZyYW5jaXNjbzEPMA0GA1UECxMGY2xpZW50MR8wHQYDVQQDDBZBZG1pbkBv\ncmcxLmV4YW1wbGUuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEKIwoqNSA\ndqmQK+5tAg4ZrxDWSWyWFTANE2hZeK3gMrb1Ps0jmS2biYNk3UbHHgDF4/AfxMXC\nIbqm5evhIvcAl6NNMEswDgYDVR0PAQH/BAQDAgeAMAwGA1UdEwEB/wQCMAAwKwYD\nVR0jBCQwIoAgYwHBX2iF8dp2gqrQuogW4WKORHHCS57o1yDmsNV9tDowCgYIKoZI\nzj0EAwIDSAAwRQIhAPYyUtbWkgrulvZ6mRV90ideWIyPJYdwXu69WMjuWKfeAiAA\niaabEtn72VlOMIyrTOsDr3DN+LpGTa/K7vfM8p4q3Q==\n-----END CERTIFICATE-----\nB\016\n\004SHA2\022\006SHA256J\327\006-----BEGIN CERTIFICATE-----\nMIICSTCCAe+gAwIBAgIQZN1HbaRhQe+O98hf28VSoDAKBggqhkjOPQQDAjB2MQsw\nCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNU2FuIEZy\nYW5jaXNjbzEZMBcGA1UEChMQb3JnMS5leGFtcGxlLmNvbTEfMB0GA1UEAxMWdGxz\nY2Eub3JnMS5leGFtcGxlLmNvbTAeFw0xOTAyMjEwMzE0MDBaFw0yOTAyMTgwMzE0\nMDBaMHYxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQH\nEw1TYW4gRnJhbmNpc2NvMRkwFwYDVQQKExBvcmcxLmV4YW1wbGUuY29tMR8wHQYD\nVQQDExZ0bHNjYS5vcmcxLmV4YW1wbGUuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0D\nAQcDQgAEunaMmMwdn7xkHSzOrJc+0dvgqifEQNZ1TiGAGtyvKTAFs3od81aQILeU\ny7nYXZ/VqHV0m2ohNq86R1rnCeddMaNfMF0wDgYDVR0PAQH/BAQDAgGmMA8GA1Ud\nJQQIMAYGBFUdJQAwDwYDVR0TAQH/BAUwAwEB/zApBgNVHQ4EIgQgKMVPJvRxT1uu\nXhYYn+phMaHXgf4w0ekBs0A5tZQaCyEwCgYIKoZIzj0EAwIDSAAwRQIhAINb/WFR\n7fLKkSP11W0kFWvDj7RHTmUJB5avxazeg5gzAiBcOIGt93WpjY11KWUGrzAepMMg\nkL6DOCz48P+sJvT7Wg==\n-----END CERTIFICATE-----\nZ\272\r\010\001\022\332\006\n\317\006-----BEGIN CERTIFICATE-----\nMIICQzCCAemgAwIBAgIQSzrwaUb5ktYvJzlJTNI2tTAKBggqhkjOPQQDAjBzMQsw\nCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNU2FuIEZy\nYW5jaXNjbzEZMBcGA1UEChMQb3JnMS5leGFtcGxlLmNvbTEcMBoGA1UEAxMTY2Eu\nb3JnMS5leGFtcGxlLmNvbTAeFw0xOTAyMjEwMzE0MDBaFw0yOTAyMTgwMzE0MDBa\nMHMxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1T\nYW4gRnJhbmNpc2NvMRkwFwYDVQQKExBvcmcxLmV4YW1wbGUuY29tMRwwGgYDVQQD\nExNjYS5vcmcxLmV4YW1wbGUuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE\ntJZZcvoFBzN6Uqd2aB1uJykRwmArk+AkoFA/Q4pZw/UfdgXP2gq4PepgOiqFPMbv\nIngDEoJ+UgeqXn54lFGaUqNfMF0wDgYDVR0PAQH/BAQDAgGmMA8GA1UdJQQIMAYG\nBFUdJQAwDwYDVR0TAQH/BAUwAwEB/zApBgNVHQ4EIgQgYwHBX2iF8dp2gqrQuogW\n4WKORHHCS57o1yDmsNV9tDowCgYIKoZIzj0EAwIDSAAwRQIhAIEygEzATAwZ8OEU\nkF/DgB3h9hjS3imFRjFWOz3Bo9CQAiA8OMPhq4pdehrIqjtGw9iASAxpFcKTHOY4\nUmPDBehBXA==\n-----END CERTIFICATE-----\n\022\006client\032\330\006\n\317\006-----BEGIN CERTIFICATE-----\nMIICQzCCAemgAwIBAgIQSzrwaUb5ktYvJzlJTNI2tTAKBggqhkjOPQQDAjBzMQsw\nCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNU2FuIEZy\nYW5jaXNjbzEZMBcGA1UEChMQb3JnMS5leGFtcGxlLmNvbTEcMBoGA1UEAxMTY2Eu\nb3JnMS5leGFtcGxlLmNvbTAeFw0xOTAyMjEwMzE0MDBaFw0yOTAyMTgwMzE0MDBa\nMHMxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1T\nYW4gRnJhbmNpc2NvMRkwFwYDVQQKExBvcmcxLmV4YW1wbGUuY29tMRwwGgYDVQQD\nExNjYS5vcmcxLmV4YW1wbGUuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE\ntJZZcvoFBzN6Uqd2aB1uJykRwmArk+AkoFA/Q4pZw/UfdgXP2gq4PepgOiqFPMbv\nIngDEoJ+UgeqXn54lFGaUqNfMF0wDgYDVR0PAQH/BAQDAgGmMA8GA1UdJQQIMAYG\nBFUdJQAwDwYDVR0TAQH/BAUwAwEB/zApBgNVHQ4EIgQgYwHBX2iF8dp2gqrQuogW\n4WKORHHCS57o1yDmsNV9tDowCgYIKoZIzj0EAwIDSAAwRQIhAIEygEzATAwZ8OEU\nkF/DgB3h9hjS3imFRjFWOz3Bo9CQAiA8OMPhq4pdehrIqjtGw9iASAxpFcKTHOY4\nUmPDBehBXA==\n-----END CERTIFICATE-----\n\022\004peer\032\006Admins\"0\n\007Readers\022%\022\033\010\001\022\027\022\010\022\006\010\001\022\002\010\000\032\013\022\t\n\007Org1MSP\032\006Admins\"0\n\007Writers\022%\022\033\010\001\022\027\022\010\022\006\010\001\022\002\010\000\032\013\022\t\n\007Org1MSP\032\006Admins\"1\n\006Admins\022'\022\035\010\001\022\031\022\010\022\006\010\001\022\002\010\000\032\r\022\013\n\007Org1MSP\020\001\032\006Admins*\006Admins\022\363\"\n\007Org2MSP\022\347\"\032\305!\n\003MSP\022\275!\022\262!\022\257!\n\007Org2MSP\022\317\006-----BEGIN CERTIFICATE-----\nMIICQzCCAeqgAwIBAgIRAPX01FolxSsbN+qGkDN+Lo0wCgYIKoZIzj0EAwIwczEL\nMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNhbiBG\ncmFuY2lzY28xGTAXBgNVBAoTEG9yZzIuZXhhbXBsZS5jb20xHDAaBgNVBAMTE2Nh\nLm9yZzIuZXhhbXBsZS5jb20wHhcNMTkwMjIxMDMxNDAwWhcNMjkwMjE4MDMxNDAw\nWjBzMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMN\nU2FuIEZyYW5jaXNjbzEZMBcGA1UEChMQb3JnMi5leGFtcGxlLmNvbTEcMBoGA1UE\nAxMTY2Eub3JnMi5leGFtcGxlLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IA\nBB4IAJjdFJwzOURFo76N5wr4Hyt+/QFWzM4dTKYP1C5lWdVZLzwBHlWuKfWpDlYa\nojC3yDatPAG/vNFaTeQpj/mjXzBdMA4GA1UdDwEB/wQEAwIBpjAPBgNVHSUECDAG\nBgRVHSUAMA8GA1UdEwEB/wQFMAMBAf8wKQYDVR0OBCIEIF7ASYqQdFqzBfuDVA4l\nUqSk3prG0dKLVhtShyR/8ypwMAoGCCqGSM49BAMCA0cAMEQCIADgnQp9dN+cEAcX\ndRfToq6LRa8w6Q7xk0wt47E2pGo7AiAXe6gkv6HI1nsN6ziViCB55xa+0Fl6cfLE\nSPG/JuNKZg==\n-----END CERTIFICATE-----\n\"\252\006-----BEGIN CERTIFICATE-----\nMIICKTCCAdCgAwIBAgIQTPoBnU3bIUP9z5RWrtv8zDAKBggqhkjOPQQDAjBzMQsw\nCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNU2FuIEZy\nYW5jaXNjbzEZMBcGA1UEChMQb3JnMi5leGFtcGxlLmNvbTEcMBoGA1UEAxMTY2Eu\nb3JnMi5leGFtcGxlLmNvbTAeFw0xOTAyMjEwMzE0MDBaFw0yOTAyMTgwMzE0MDBa\nMGwxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1T\nYW4gRnJhbmNpc2NvMQ8wDQYDVQQLEwZjbGllbnQxHzAdBgNVBAMMFkFkbWluQG9y\nZzIuZXhhbXBsZS5jb20wWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAAT7aBXOssgU\nf7Wjb6bQaxP4y4CZc36UPURJ1qQyGc+CBntEEcdNJX5BbK3KPNw7SlAzJWBLzVAR\nuOxOWBSd8lCWo00wSzAOBgNVHQ8BAf8EBAMCB4AwDAYDVR0TAQH/BAIwADArBgNV\nHSMEJDAigCBewEmKkHRaswX7g1QOJVKkpN6axtHSi1YbUockf/MqcDAKBggqhkjO\nPQQDAgNHADBEAiAnnzRpEldJqGcQfyIcFoMMF8xu9epvMZBl1mJdO2CmYwIgGqWd\nhU81+oitm/y1YadT+6RAF1V0qtscisOBuySiCbI=\n-----END CERTIFICATE-----\nB\016\n\004SHA2\022\006SHA256J\327\006-----BEGIN CERTIFICATE-----\nMIICSjCCAfCgAwIBAgIRAL3k6At3NZGnrOEGzTGbFYgwCgYIKoZIzj0EAwIwdjEL\nMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNhbiBG\ncmFuY2lzY28xGTAXBgNVBAoTEG9yZzIuZXhhbXBsZS5jb20xHzAdBgNVBAMTFnRs\nc2NhLm9yZzIuZXhhbXBsZS5jb20wHhcNMTkwMjIxMDMxNDAwWhcNMjkwMjE4MDMx\nNDAwWjB2MQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UE\nBxMNU2FuIEZyYW5jaXNjbzEZMBcGA1UEChMQb3JnMi5leGFtcGxlLmNvbTEfMB0G\nA1UEAxMWdGxzY2Eub3JnMi5leGFtcGxlLmNvbTBZMBMGByqGSM49AgEGCCqGSM49\nAwEHA0IABEkLa+OCV8an17RCgtx+iQuskbsvszHbKRRVeyKZm5yLXyYf8AUauB7D\nxxUPdgUcvzlGU1/BTeCZLKLb96j2rS2jXzBdMA4GA1UdDwEB/wQEAwIBpjAPBgNV\nHSUECDAGBgRVHSUAMA8GA1UdEwEB/wQFMAMBAf8wKQYDVR0OBCIEIF/n1d5AYzsd\npapbCaL6ArlwTjfp7I7vPB9+0IMvEGGYMAoGCCqGSM49BAMCA0gAMEUCIQC1Fhtf\ntC3oXG1YbGXSzIpunJIZrIRhs+i+nWux4gp1LAIgbxegybIvxn/BsLMu9ogGq7Dk\n03u8DVkkF65PWzR1tw8=\n-----END CERTIFICATE-----\nZ\272\r\010\001\022\332\006\n\317\006-----BEGIN CERTIFICATE-----\nMIICQzCCAeqgAwIBAgIRAPX01FolxSsbN+qGkDN+Lo0wCgYIKoZIzj0EAwIwczEL\nMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNhbiBG\ncmFuY2lzY28xGTAXBgNVBAoTEG9yZzIuZXhhbXBsZS5jb20xHDAaBgNVBAMTE2Nh\nLm9yZzIuZXhhbXBsZS5jb20wHhcNMTkwMjIxMDMxNDAwWhcNMjkwMjE4MDMxNDAw\nWjBzMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMN\nU2FuIEZyYW5jaXNjbzEZMBcGA1UEChMQb3JnMi5leGFtcGxlLmNvbTEcMBoGA1UE\nAxMTY2Eub3JnMi5leGFtcGxlLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IA\nBB4IAJjdFJwzOURFo76N5wr4Hyt+/QFWzM4dTKYP1C5lWdVZLzwBHlWuKfWpDlYa\nojC3yDatPAG/vNFaTeQpj/mjXzBdMA4GA1UdDwEB/wQEAwIBpjAPBgNVHSUECDAG\nBgRVHSUAMA8GA1UdEwEB/wQFMAMBAf8wKQYDVR0OBCIEIF7ASYqQdFqzBfuDVA4l\nUqSk3prG0dKLVhtShyR/8ypwMAoGCCqGSM49BAMCA0cAMEQCIADgnQp9dN+cEAcX\ndRfToq6LRa8w6Q7xk0wt47E2pGo7AiAXe6gkv6HI1nsN6ziViCB55xa+0Fl6cfLE\nSPG/JuNKZg==\n-----END CERTIFICATE-----\n\022\006client\032\330\006\n\317\006-----BEGIN CERTIFICATE-----\nMIICQzCCAeqgAwIBAgIRAPX01FolxSsbN+qGkDN+Lo0wCgYIKoZIzj0EAwIwczEL\nMAkGA1UEBhMCVVMxEzARBgNVBAgTCkNhbGlmb3JuaWExFjAUBgNVBAcTDVNhbiBG\ncmFuY2lzY28xGTAXBgNVBAoTEG9yZzIuZXhhbXBsZS5jb20xHDAaBgNVBAMTE2Nh\nLm9yZzIuZXhhbXBsZS5jb20wHhcNMTkwMjIxMDMxNDAwWhcNMjkwMjE4MDMxNDAw\nWjBzMQswCQYDVQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMN\nU2FuIEZyYW5jaXNjbzEZMBcGA1UEChMQb3JnMi5leGFtcGxlLmNvbTEcMBoGA1UE\nAxMTY2Eub3JnMi5leGFtcGxlLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IA\nBB4IAJjdFJwzOURFo76N5wr4Hyt+/QFWzM4dTKYP1C5lWdVZLzwBHlWuKfWpDlYa\nojC3yDatPAG/vNFaTeQpj/mjXzBdMA4GA1UdDwEB/wQEAwIBpjAPBgNVHSUECDAG\nBgRVHSUAMA8GA1UdEwEB/wQFMAMBAf8wKQYDVR0OBCIEIF7ASYqQdFqzBfuDVA4l\nUqSk3prG0dKLVhtShyR/8ypwMAoGCCqGSM49BAMCA0cAMEQCIADgnQp9dN+cEAcX\ndRfToq6LRa8w6Q7xk0wt47E2pGo7AiAXe6gkv6HI1nsN6ziViCB55xa+0Fl6cfLE\nSPG/JuNKZg==\n-----END CERTIFICATE-----\n\022\004peer\032\006Admins\"1\n\006Admins\022'\022\035\010\001\022\031\022\010\022\006\010\001\022\002\010\000\032\r\022\013\n\007Org2MSP\020\001\032\006Admins\"0\n\007Readers\022%\022\033\010\001\022\027\022\010\022\006\010\001\022\002\010\000\032\013\022\t\n\007Org2MSP\032\006Admins\"0\n\007Writers\022%\022\033\010\001\022\027\022\010\022\006\010\001\022\002\010\000\032\013\022\t\n\007Org2MSP\032\006Admins*\006Admins\032@\n\025ChannelCreationPolicy\022'\022\014\010\003\022\010\n\006Admins\032\027/Channel/Orderer/Admins*\027/Channel/Orderer/Admins\"-\n\006Admins\022#\022\010\010\001\022\004\022\002\022\000\032\027/Channel/Orderer/Admins*\027/Channel/Orderer/Admins\032&\n\020HashingAlgorithm\022\022\022\010\n\006SHA256\032\006Admins\032-\n\031BlockDataHashingStructure\022\020\022\006\010\377\377\377\377\017\032\006Admins\032I\n\020OrdererAddresses\0225\022\032\n\030orderer.example.com:7050\032\027/Channel/Orderer/Admins\"\"\n\006Admins\022\030\022\016\010\003\022\n\n\006Admins\020\002\032\006Admins\"\"\n\007Readers\022\027\022\r\010\003\022\t\n\007Readers\032\006Admins\"\"\n\007Writers\022\027\022\r\010\003\022\t\n\007Writers\032\006Admins*\006Admins" > metadata:<metadata:"" metadata:"" metadata:"" metadata:"" >


4  共识
consenters := make(map[string]consensus.Consenter)
	consenters["solo"] = solo.New()
	consenters["kafka"] = kafka.New(conf.Kafka)

5 reister
// Registrar serves as a point of access and control for the individual channel resources.
type Registrar struct {
	lock   sync.RWMutex
	chains map[string]*ChainSupport

	consenters      map[string]consensus.Consenter
	ledgerFactory   blockledger.Factory
	signer          crypto.LocalSigner
	systemChannelID string
	systemChannel   *ChainSupport
	templator       msgprocessor.ChannelConfigTemplator
	callbacks       []func(bundle *channelconfig.Bundle)
}

6 创建AtomBroadCastServer
// NewServer creates an ab.AtomicBroadcastServer based on the broadcast target and ledger Reader

type server struct {
	bh    broadcast.Handler
	dh    *deliver.Handler
	debug *localconfig.Debug
	*multichannel.Registrar
}

gRPC服务器反射提供关于服务器上可公开访问的gRPC服务的信息，并在运行时帮助客户机在没有预编译服务信息的情况下构造RPC请求和响应。它由gRPC CLI使用，它可以用于内省服务器原型和发送/接收测试rpc。

// NewServer creates an ab.AtomicBroadcastServer based on the broadcast target and ledger Reader
func NewServer(r *multichannel.Registrar, _ crypto.LocalSigner, debug *localconfig.Debug, timeWindow time.Duration, mutualTLS bool) ab.AtomicBroadcastServer {
	s := &server{
		dh:        deliver.NewHandler(deliverSupport{Registrar: r}, timeWindow, mutualTLS),
		bh:        broadcast.NewHandlerImpl(broadcastSupport{Registrar: r}),
		debug:     debug,
		Registrar: r,
	}
	return s
}

NewServer 返回一个AtomicBroadcastServer 的实例； 为什么明明是一个Server的实例，但是却能转换为AbS的实例呢？
因为server实现了ABS中的方法
    Broadcast(AtomicBroadcast_BroadcastServer) error
	// deliver first requires an Envelope of type DELIVER_SEEK_INFO with Payload data as a mashaled SeekInfo message, then a stream of block replies is received.
	Deliver(AtomicBroadcast_DeliverServer) error
那么这个server就是ABS的子类 并且新增了自己的独特方法。

